import{supabase}from"./config.js";function updateWaterLevel3(e){e<0&&(e=0),e>100&&(e=100);const t=document.querySelector("#bloco3 .water-container"),a=document.getElementById("water-level3");if(!t||!a)return;const o=t.clientHeight,n=.08*o,r=.78*o,c=n+100*Math.pow(e/100,1.2)/100*(r-n);a.style.height=`${c}px`;const l=document.querySelector("#bloco3 .capsula-nivel");l&&(l.textContent=`${e.toFixed(0)}%`)}function updateVoltimetro3(e){e<0&&(e=0),e>300&&(e=300),animateNeedle(document.getElementById("ponteiro-voltimetro3"),e/300*260);const t=document.querySelector("#bloco3 .capsula-voltimetro");t&&(t.textContent=`${e.toFixed(0)} V`)}function updateAmperimetro3(e){e<0&&(e=0),e>60&&(e=60),animateNeedle(document.getElementById("ponteiro-amperimetro3"),e/60*260);const t=document.querySelector("#bloco3 .capsula-amperimetro");t&&(t.textContent=`${e.toFixed(0)} A`)}function animateNeedle(e,t){e.animationFrame&&cancelAnimationFrame(e.animationFrame);let a=parseFloat(e.dataset.angle)||0;const o=(t-a)/40;!function n(){a+=o,o>0&&a>=t||o<0&&a<=t?a=t:e.animationFrame=requestAnimationFrame(n),e.style.transform=`rotate(${a}deg)`,e.dataset.angle=a}()}async function fetchDataFromSupabase(){const{data:e,error:t}=await supabase.from("dados").select("*").eq("id",1383);if(!t)return e&&e.length>0&&updateInterface(e[0].payload.dados),supabase.channel("custom-all-channel").on("postgres_changes",{event:"UPDATE",schema:"public",table:"dados",filter:"id=eq.1383"},(e=>{updateInterface(e.new.dados)})).subscribe();console.error("Erro ao buscar dados do Supabase:",t)}function updateInterface(e){const t=e.Bloco3;if(t){updateWaterLevel3(t.nivel_agua),updateVoltimetro3(t.tensao_bomba),updateAmperimetro3(t.corrente_bomba);const e=document.querySelector("#bloco3 .capsula-status");e&&(e.textContent=t.bomba_ligada?"Bomba Ligada":"Bomba Desligada",e.style.backgroundColor=t.bomba_ligada?"#4CAF50":"#f44336")}}setInterval(fetchDataFromSupabase,1e3);